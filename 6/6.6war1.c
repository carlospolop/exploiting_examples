#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

int target;

void vuln(char* string){
    
    printf(string);
    if(target){
        printf("you have hit the target correctly :)\n");
    }
}

int main(int argc, char **argv){
    vuln(argv[1]);
}

/*
Hay que buscar la direccion de target con: objdump -j | grep target
Después hay que buscar en qué offset podemos acceder a los parámetros enviados a printf
Finalmente el exploit sería: "Dir_target"%(offset)\$08n --> Así escribimos el valor 4 en target
Problemas encontrados: target se encuentra en el bss y esté está al principio de la memoria, la direccion de target contiene 2 bytes nulos que no se le pueden pasar a printf
No hay forma de encontrar el offset para saber cómo acceder a lo enviado
